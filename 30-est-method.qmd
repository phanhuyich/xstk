# Ước lượng

Chiến lược ước lượng phân phối *thật* (true distribution)

- Định nghĩa khoảng cách giữa các phân phối (TV distance)
- Ước lượng khoảng cách nêu trên (KL divergence)
- Tìm điểm cực tiểu của ước lượng nêu trên (minimization).

Với mô hình thống kê
$(E,(\P_\theta)_{\theta\in\Theta})$
xây dựng dựa trên quan sát iid rv
$X_1,\ldots,X_n$
trên tập mẫu $E$
và bộ tham số $\Theta$
.
Ngầm định tồn tại
*tham số thật*
$\theta^*\in\Theta$
để
$X_1\sim\P_{\theta^*}$
.

## Tổng biến động
::: {#def-total-variation}
### Khoảng cách
tổng biến động
(total variation distance)
giữa hai độ đo xác suất
$\P_\theta$ và
$\P_\eta$
là

$$
\TV(\P_\theta,\P_{\eta})
=
\max_{A\subset E}{\mid\P_\theta(A)-\P_\eta(A)\mid}.
$$
:::

:::{#thm-total-variation}
### Công thức tính

Nếu tập mẫu $E$ là rời rạc
(discrete: countable or finite),
xác suất
$\P_\theta,\P_{\eta}$
có hàm khối lần lượt là
$p_\theta,p_{\eta}$
thì
$$
\TV(\P_\theta,\P_{\eta}) =
\frac{1}{2}
\sum_{x\in E}\mid p_\theta(x) - p_\eta(x)\mid.
$$

Nếu tập mẫu $E$ là liên tục
(continuous),
xác suất
$\P_\theta, \P_{\eta}$
có mật độ lần lượt là
$f_\theta, f_{\eta}$
thì
$$
\TV(\P_\theta,\P_{\eta}) =
\frac{1}{2}
\int_{E}\mid f_\theta(x) - f_\eta(x)\mid dx.
$$
:::

## Phân kỳ KL

:::{#def-kl-divergence}
### Phân kỳ KL
(KL divergence)
Ký hiệu $f$ là
mật độ
hoặc
hàm khối xác suất:

$$
\KL(\P_\theta, \P_\eta) \is
\E_\theta\left[ \ln\frac{f_\theta(x)}{f_\eta(x)} \right]
=
\E_\theta\left[ \ln{f_\theta(x)} \right]
-
\E_\theta\left[ \ln{f_\eta(x)} \right]
.
$$
:::

:::{#prp-kl-properties}
### Đặc điểm
Phân kỳ KL
thỏa mãn 2/4 đặc điểm của "khoảng cách":

1. $\KL(\P_\theta, \P_\eta) \geq 0$
2. $\KL(\P_\theta, \P_\eta) \equiv 0 \iff \P_\theta \equiv \P_\eta$.
:::

## MLE

Maximum Likelihood Estimation

:::{#def-likelihood}
### Likelihood
$$L_\theta(x_1,\ldots,x_n)\is
\P_\theta(X_1=x_1,\ldots,X_n=x_n)
=
\prod_{i=1}^n p_\theta(X_i=x_i)
.$$
:::

:::{#def-likelihood}
### Log likelihood
$$
\ell_\theta(x_1,\ldots,x_n)\is
\ln
L_\theta(x_1,\ldots,x_n)
=
\sum_{i=1}^n \ln p_\theta(X_i=x_i)
.
$$
:::

:::{#def-mle}
### Maximum Likelihood Estimator

$$
\hat{\theta}_n \is
\operatorname*{argmax}_\theta
L_\theta(x_1,\ldots,x_n)
\equiv
\operatorname*{argmax}_\theta
\ell_\theta(x_1,\ldots,x_n)
.
$$
:::

:::{#def-mix-model}
### Mix model
Cho
các mô hình gốc
$X^{(k)}, k= 1,\ldots,K,$
lấy
biến tiềm ẩn
$Z$
trên
$\{1,\ldots,K\}$
làm trọng số,
ta có mô hình hỗn hợp
$$
X = \sum_{k=1}^K
\P(Z=k) X^{(k)}
.
$$
:::

:::{#def-em-alg}
### Giải thuật EM
(Estimation Maximization)
để tìm các
tham số của
mô hình hỗn hợp @def-mix-model.
Nhập liệu là các quan sát
$X_1, \ldots, X_n$.
Gọi các trọng số tiềm ẩn là
$Z_1, \ldots, Z_n.$
Sau khi khởi tạo các tham số bằng giá trị ngẫu nhiên,
ta
lặp lại 2 bước E, M như sau
để cập nhật các tham số
cho đến khi chúng hội tụ.

- Bước E: Ước lượng $Z_i\approx\omega_i\is\E[Z|X_i], i=1,\ldots,n.$
- Bước M: Thay $Z_i$ bởi $\omega_i$ vào log likelihood để tìm MLE cho $X$.
:::
